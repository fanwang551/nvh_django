# VOC全谱检测数据管理需求文档

## 一、功能概述
实现VOC全谱检测数据的查询、展示和管理功能，包括筛选查询、测试信息展示、全谱物质详情查看等。

## 二、功能需求
界面共三个模块：筛选框、测试信息表、全谱信息
### 2.1 筛选查询功能
**参考实现**：`D:\pythonProject\zlbbses\nvh_django\frontend\src\views\vehicle-data\VocOdorData.vue`

**筛选条件**（支持单选或多选组合）：
- 项目名称
- 零件名称
- 检测状态
- 开发阶段
- 测试时间（时间范围）
- 委托单号
- 样品编号

### 2.2 测试信息表展示
表右上角添加一个可选择按钮选择检测时间、检测状态、开发阶段、委托单号、样品编号为可选显示，参考VocOdorData.vue实现
**表头字段**：
| 字段名 | 说明 |
|--------|------|
| 项目名称 | |
| 检测时间 | |
| 零部件 | |
| 检测状态 | |
| 开发阶段 | |
| 委托单号 | |
| 样品编号 | |
| 气味污染指数Oi | |
| 气味污染贡献度Goi | |
| 有机物污染指数Vi | |
| 有机物污染贡献度Gvi | |
| 详情 | 包含两个按钮：「样品图」「全谱」 |

**交互说明**：
- 点击「样品图」按钮：弹窗显示样品图片（参考VocOdorData.vue实现）
- 点击「全谱」按钮：在全谱信息模块显示全谱物质信息表

### 2.3 全谱物质信息表

**表头字段**：
| 字段名 | 说明 |
|--------|------|
| 物质名称 | 中文名称，可点击 |
| 物质英文名 | |
| CAS号 | |
| 匹配度 | 百分比显示 |
| 保留时间 | 单位：分钟 |
| 浓度占比(%) | |
| 浓度(μg/m³) | |

**交互说明**：
- 点击「物质名称」：弹窗以卡片形式展示物质详细信息（包含物质库中的所有字段）

## 三、数据库设计

### 3.1 全谱物质库表 (substances)
```sql
字段名                  类型              说明              约束
id                    INT              主键              自增
substance_name_cn     VARCHAR(100)     物质中文名         NOT NULL
substance_name_en     VARCHAR(100)     物质英文名         
cas_no                VARCHAR(50)      CAS号             UNIQUE
odor_threshold        DECIMAL(12,3)    嗅阈值(μg/m³)     
organic_threshold     DECIMAL(12,3)    有机物阈值         
limit_value           DECIMAL(12,3)    限值              
odor_character        VARCHAR(200)     气味特性          
main_usage            TEXT             主要用途          
remark                TEXT             备注              
```

### 3.2 全谱检测主表 (substances_test)
```sql
字段名          类型              说明                      约束
id            INT              主键                      自增
sample_id     INT              样品ID                    外键，关联样品信息表
oi            DECIMAL(10,3)    气味污染指数Oi            
goi           DECIMAL(10,3)    气味污染贡献度GOi         
vi            DECIMAL(10,3)    有机污染指数Vi            
gvi           DECIMAL(10,3)    有机污染贡献度GVi         
test_date     DATETIME         检测时间                  

索引：idx_sample_id
```

### 3.3 全谱检测明细表 (substances_test_detail)
```sql
字段名                  类型              说明                          约束
id                    INT              主键                          自增
substances_test_id    INT              全谱检测主表ID                外键，关联substances_test
substance_id          INT              物质ID                        外键，关联substances
retention_time        DECIMAL(8,4)     保留时间                
match_degree          DECIMAL(5,2)     匹配度(0-100)                 
concentration         DECIMAL(12,6)    浓度(μg/m³)                   
concentration_ratio   DECIMAL(8,3)     浓度占比(%)                   
dilution_oij          DECIMAL(10,3)    稀释倍数Oij                   
dilution_wih          DECIMAL(10,3)    挥发性有机物阈稀释倍数Wih     

索引：idx_substances_test_id, idx_substance_id
```

## 四、技术实现要求

### 4.1 后端
- 模块位置：`apps/voc/`
- 框架：Django
- 需实现接口：
  - 筛选查询接口
  - 测试信息列表接口
  - 全谱物质详情接口
  - 物质信息详情接口

### 4.2 前端
- 技术栈：Vue 3 + Pinia
- 代码规范：与现有项目保持一致
直接在"D:\pythonProject\zlbbses\nvh_django\frontend\src\views\vehicle-data\FullSpectrumData.vue"中编写代码，但是需要重命名为SubstancesData.vue
